<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Portal - AI-Enhanced Society Issue Tracker</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="navbar admin-navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <i class="fas fa-shield-alt"></i>
                    <span>Admin Portal</span>
                </div>
                <div class="nav-menu">
                    <button class="nav-btn active" data-view="dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </button>
                    <button class="nav-btn" data-view="users">
                        <i class="fas fa-users"></i> User Management
                    </button>
                    <button class="nav-btn" data-view="complaints">
                        <i class="fas fa-exclamation-triangle"></i> Complaints
                    </button>
                    <button class="nav-btn" data-view="staff">
                        <i class="fas fa-user-tie"></i> Staff Management
                    </button>
                    <button class="nav-btn" data-view="analytics">
                        <i class="fas fa-chart-bar"></i> Analytics
                    </button>
                    <button class="nav-btn" data-view="settings">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                </div>
                <div class="user-info">
                    <div class="user-dropdown">
                        <button class="user-btn" onclick="toggleUserDropdown()">
                            <i class="fas fa-user-circle"></i>
                            <span id="admin-name">Admin</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="user-dropdown-menu" id="user-dropdown">
                            <a href="#" onclick="showProfile()">
                                <i class="fas fa-user"></i> Profile
                            </a>
                            <a href="#" onclick="showChangePassword()">
                                <i class="fas fa-key"></i> Change Password
                            </a>
                            <a href="#" onclick="showActivityLog()">
                                <i class="fas fa-history"></i> Activity Log
                            </a>
                            <hr>
                            <a href="#" onclick="logout()" class="logout-link">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content admin-content">
            <!-- Dashboard View -->
            <div id="dashboard-view" class="view active">
                <div class="admin-header">
                    <h1>Admin Dashboard</h1>
                    <p class="subtitle">Society management and system overview</p>
                </div>

                <!-- Key Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card users">
                        <div class="metric-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="metric-info">
                            <h3 id="total-users">0</h3>
                            <p>Total Users</p>
                            <span class="metric-change" id="users-change">+0 this month</span>
                        </div>
                    </div>
                    <div class="metric-card complaints">
                        <div class="metric-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="metric-info">
                            <h3 id="total-complaints">0</h3>
                            <p>Total Complaints</p>
                            <span class="metric-change" id="complaints-change">+0 this week</span>
                        </div>
                    </div>
                    <div class="metric-card resolution">
                        <div class="metric-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-info">
                            <h3 id="avg-resolution">0h</h3>
                            <p>Avg Resolution Time</p>
                            <span class="metric-change" id="resolution-change">-0% from last month</span>
                        </div>
                    </div>
                    <div class="metric-card satisfaction">
                        <div class="metric-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="metric-info">
                            <h3 id="satisfaction-rate">0%</h3>
                            <p>Satisfaction Rate</p>
                            <span class="metric-change" id="satisfaction-change">+0% this month</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h2>Quick Actions</h2>
                    <div class="action-grid">
                        <button class="action-btn" onclick="showAddUserModal()">
                            <i class="fas fa-user-plus"></i>
                            <span>Add New User</span>
                        </button>
                        <button class="action-btn" onclick="showAddStaffModal()">
                            <i class="fas fa-user-tie"></i>
                            <span>Add Staff Member</span>
                        </button>
                        <button class="action-btn" onclick="showSystemSettings()">
                            <i class="fas fa-cog"></i>
                            <span>System Settings</span>
                        </button>
                        <button class="action-btn" onclick="generateReport()">
                            <i class="fas fa-file-alt"></i>
                            <span>Generate Report</span>
                        </button>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="recent-activity">
                    <h2>Recent Activity</h2>
                    <div id="activity-feed" class="activity-feed">
                        <!-- Activity items will be populated here -->
                    </div>
                </div>

                <!-- Pending Approvals -->
                <div id="pending-approvals" class="pending-approvals" style="display: none;">
                    <h2>Pending Approvals</h2>
                    <div id="approval-list" class="approval-list">
                        <!-- Pending items will be populated here -->
                    </div>
                </div>
            </div>

            <!-- User Management View -->
            <div id="users-view" class="view">
                <div class="section-header">
                    <h1>User Management</h1>
                    <div class="section-actions">
                        <button class="btn-primary" onclick="showAddUserModal()">
                            <i class="fas fa-plus"></i> Add User
                        </button>
                        <button class="btn-secondary" onclick="exportUsers()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>

                <!-- User Filters -->
                <div class="filters-section">
                    <div class="filter-group">
                        <label>Role:</label>
                        <select id="user-role-filter">
                            <option value="">All Roles</option>
                            <option value="admin">Admin</option>
                            <option value="secretary">Secretary</option>
                            <option value="resident">Resident</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Status:</label>
                        <select id="user-status-filter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="pending">Pending</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Search:</label>
                        <input type="text" id="user-search" placeholder="Search users...">
                    </div>
                </div>

                <!-- Users Table -->
                <div class="table-container">
                    <table class="data-table" id="users-table">
                        <thead>
                            <tr>
                                <th>
                                    <input type="checkbox" id="select-all-users">
                                </th>
                                <th>Name</th>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body">
                            <!-- User rows will be populated here -->
                        </tbody>
                    </table>
                </div>

                <!-- Bulk Actions -->
                <div class="bulk-actions" id="user-bulk-actions" style="display: none;">
                    <select id="user-bulk-action">
                        <option value="">Bulk Actions</option>
                        <option value="activate">Activate</option>
                        <option value="deactivate">Deactivate</option>
                        <option value="delete">Delete</option>
                    </select>
                    <button class="btn-secondary" onclick="applyUserBulkAction()">Apply</button>
                </div>
            </div>

            <!-- Complaints Management View -->
            <div id="complaints-view" class="view">
                <div class="section-header">
                    <h1>Complaints Management</h1>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="exportComplaints()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>

                <!-- Complaint Filters -->
                <div class="filters-section">
                    <div class="filter-group">
                        <label>Status:</label>
                        <select id="complaint-status-filter">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="in-progress">In Progress</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Category:</label>
                        <select id="complaint-category-filter">
                            <option value="">All Categories</option>
                            <option value="plumbing">Plumbing</option>
                            <option value="electrical">Electrical</option>
                            <option value="cleaning">Cleaning</option>
                            <option value="security">Security</option>
                            <option value="parking">Parking</option>
                            <option value="lift">Lift</option>
                            <option value="structural">Structural</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Priority:</label>
                        <select id="complaint-priority-filter">
                            <option value="">All Priorities</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Search:</label>
                        <input type="text" id="complaint-search" placeholder="Search complaints...">
                    </div>
                </div>

                <!-- Complaints List -->
                <div id="admin-complaints-list" class="complaints-list admin">
                    <!-- Complaints will be populated here -->
                </div>
            </div>

            <!-- Staff Management View -->
            <div id="staff-view" class="view">
                <div class="section-header">
                    <h1>Staff Management</h1>
                    <div class="section-actions">
                        <button class="btn-primary" onclick="showAddStaffModal()">
                            <i class="fas fa-plus"></i> Add Staff
                        </button>
                    </div>
                </div>

                <div id="staff-grid" class="staff-grid">
                    <!-- Staff cards will be populated here -->
                </div>
            </div>

            <!-- Analytics View -->
            <div id="analytics-view" class="view">
                <div class="section-header">
                    <h1>Analytics & Reports</h1>
                    <div class="section-actions">
                        <button class="btn-secondary" onclick="refreshAnalytics()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                </div>

                <div class="analytics-dashboard">
                    <div class="chart-grid">
                        <div class="chart-container">
                            <h3>User Growth</h3>
                            <canvas id="user-growth-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3>Complaint Trends</h3>
                            <canvas id="complaint-trends-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3>Category Distribution</h3>
                            <canvas id="category-distribution-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3>Staff Performance</h3>
                            <canvas id="staff-performance-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="settings-view" class="view">
                <div class="section-header">
                    <h1>System Settings</h1>
                </div>

                <div class="settings-grid">
                    <div class="settings-section">
                        <h3>General Settings</h3>
                        <form id="general-settings-form">
                            <div class="form-group">
                                <label for="society-name">Society Name</label>
                                <input type="text" id="society-name" name="societyName" value="Green Valley Society">
                            </div>
                            <div class="form-group">
                                <label for="admin-email">Admin Email</label>
                                <input type="email" id="admin-email" name="adminEmail" value="admin@society.com">
                            </div>
                            <div class="form-group">
                                <label for="auto-assignment">Auto Assignment</label>
                                <label class="switch">
                                    <input type="checkbox" id="auto-assignment" name="autoAssignment" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </form>
                    </div>

                    <div class="settings-section">
                        <h3>AI Settings</h3>
                        <form id="ai-settings-form">
                            <div class="form-group">
                                <label for="ai-confidence-threshold">Confidence Threshold</label>
                                <input type="range" id="ai-confidence-threshold" name="confidenceThreshold" 
                                       min="0.5" max="0.95" step="0.05" value="0.8">
                                <span class="range-value">80%</span>
                            </div>
                            <div class="form-group">
                                <label for="auto-categorization">Auto Categorization</label>
                                <label class="switch">
                                    <input type="checkbox" id="auto-categorization" name="autoCategorization" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label for="image-verification">Image Verification</label>
                                <label class="switch">
                                    <input type="checkbox" id="image-verification" name="imageVerification" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </form>
                    </div>

                    <div class="settings-section">
                        <h3>Notification Settings</h3>
                        <form id="notification-settings-form">
                            <div class="form-group">
                                <label for="email-notifications">Email Notifications</label>
                                <label class="switch">
                                    <input type="checkbox" id="email-notifications" name="emailNotifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label for="sms-notifications">SMS Notifications</label>
                                <label class="switch">
                                    <input type="checkbox" id="sms-notifications" name="smsNotifications">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="settings-actions">
                    <button class="btn-primary" onclick="saveSettings()">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                    <button class="btn-secondary" onclick="resetSettings()">
                        <i class="fas fa-undo"></i> Reset to Default
                    </button>
                </div>
            </div>
        </main>

        <!-- Add User Modal -->
        <div id="add-user-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeAddUserModal()">&times;</span>
                <h2>Add New User</h2>
                <form id="add-user-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="new-user-first-name">First Name *</label>
                            <input type="text" id="new-user-first-name" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="new-user-last-name">Last Name *</label>
                            <input type="text" id="new-user-last-name" name="lastName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="new-user-username">Username *</label>
                            <input type="text" id="new-user-username" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="new-user-email">Email *</label>
                            <input type="email" id="new-user-email" name="email" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="new-user-phone">Phone *</label>
                            <input type="tel" id="new-user-phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="new-user-role">Role *</label>
                            <select id="new-user-role" name="role" required>
                                <option value="">Select Role</option>
                                <option value="admin">Admin</option>
                                <option value="secretary">Secretary</option>
                                <option value="resident">Resident</option>
                            </select>
                        </div>
                    </div>
                    <div id="resident-fields" class="role-specific" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="new-user-block">Block</label>
                                <select id="new-user-block" name="block">
                                    <option value="">Select Block</option>
                                    <option value="A">Block A</option>
                                    <option value="B">Block B</option>
                                    <option value="C">Block C</option>
                                    <option value="D">Block D</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="new-user-flat">Flat Number</label>
                                <input type="text" id="new-user-flat" name="flat" placeholder="e.g., 101">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="new-user-password">Password *</label>
                        <input type="password" id="new-user-password" name="password" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-user-plus"></i> Add User
                        </button>
                        <button type="button" class="btn-secondary" onclick="closeAddUserModal()">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Staff Modal -->
        <div id="add-staff-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeAddStaffModal()">&times;</span>
                <h2>Add Staff Member</h2>
                <form id="add-staff-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="staff-name">Name *</label>
                            <input type="text" id="staff-name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="staff-role">Role *</label>
                            <input type="text" id="staff-role" name="role" required placeholder="e.g., Plumber">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="staff-phone">Phone *</label>
                            <input type="tel" id="staff-phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="staff-email">Email</label>
                            <input type="email" id="staff-email" name="email">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="staff-skills">Skills *</label>
                        <div class="checkbox-grid">
                            <label class="checkbox-label">
                                <input type="checkbox" name="skills" value="plumbing"> Plumbing
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="skills" value="electrical"> Electrical
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="skills" value="cleaning"> Cleaning
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="skills" value="security"> Security
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="skills" value="lift"> Lift/Elevator
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="skills" value="structural"> Structural
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="skills" value="general maintenance"> General Maintenance
                            </label>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-user-plus"></i> Add Staff
                        </button>
                        <button type="button" class="btn-secondary" onclick="closeAddStaffModal()">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay" style="display: none;">
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Processing...</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/auth-manager.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/ai-models.js"></script>
    <script src="js/admin-portal.js"></script>
</body>
</html>
